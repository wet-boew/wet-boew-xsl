<?xml version="1.0" encoding="UTF-8"?>
<project name="build-tasks" default="default" basedir=".">
	<dirname property="tasks.basedir" file="${ant.file.build-tasks}"/>
	<property file="${tasks.basedir}/build-tasks.properties"/>
	
	<property name="wet_root" value="../../wet-boew/dist"/>
	
	<path id="antcontrib.classpath">
		<pathelement location="${antcontribs.jar}" />
	</path>
	<taskdef resource="net/sf/antcontrib/antlib.xml">
		<classpath refid="antcontrib.classpath" />
	</taskdef>
	<path id="wet-boew-anttaks.classpath">
		<pathelement location="${wet-boew-anttasks.jar}" />
		<pathelement location="${opencsv.jar}" />
	</path>
	<taskdef name="I18nCSVtoXML" classname="org.wet_boew.wet_boew.ant.I18nCSVtoXML">
		<classpath refid="wet-boew-anttaks.classpath" />
	</taskdef>
	<path id="saxon-anttaks.classpath">
		<pathelement location="${saxon.jar}" />
		<pathelement location="${saxon-anttask.jar}" />
	</path>
	<taskdef name="xslt_saxon" classname="net.sf.saxon.ant.AntTransform">
		<classpath refid="saxon-anttaks.classpath" />
	</taskdef>

	<target name="clean">
		<delete dir="${demo.out.dir}" />
	</target>

	<extension-point name="build" depends="prepare-strings" description="Core build task. Subprojects should subscrib to the 'prepare-files' and 'compress'" />
	
	<target name="prepare-strings">
		<I18nCSVtoXML i18nfile="${src.dir}/../js/i18n/i18n.csv" outfile="${src.dir}/../base/xsl/i18n.xml" />
	</target>
	
	<target name="transform" extensionOf="build">
		<for param="file">
			<path>
				<fileset dir="${src.dir}/xsl/">
					<include name="*.xsl*"/>
				</fileset>
			</path>
			<sequential>
				<xslt_saxon in="${src.dir}/../base/xsl/i18n.xml" out="${demo.dir}/out.xml" style="@{file}"/>
			</sequential>
		</for>
	</target>

</project>
